import{r as x,g as J,j as i,d as S,i as G,q as Q,C as L,I as U,A as V,D as Z,s as C,c as M,v as T}from"./index-fc391d71.js";import{P as k}from"./index-2d087329.js";function K(){const t=x.useRef({});function r(p){return function(g){t.current[p]=g}}return r.current=t.current,r}var P=function(t){var r=x.useRef(t);return r.current=t,r};const ee=P,u={collapse:"mo-collapse",item:"mo-collapse__item",pane:"mo-collapse__pane",header:"mo-collapse__header",title:"mo-collapse__title",content:"mo-collapse__content",extra:"mo-collapse__extra",headerSize:"26px",transitionDelay:"150"},h=parseInt(u.headerSize,10);function te({data:t=[],activePanelKeys:r=[],className:p,title:g,style:j,role:O,onCollapseChange:_,onToolbarClick:b,onContextMenu:I}){const v=K(),[q,y]=J(),[A,R]=x.useState(new Array(t.length).fill(h)),B=x.useRef(0),F=ee(r),N=x.useRef();x.useEffect(()=>(N.current=new MutationObserver(e=>{e.forEach(s=>{D(s.target)})}),()=>{var e;(e=N.current)==null||e.disconnect(),window.clearTimeout(B.current)}),[]);const W=e=>{B.current=window.setTimeout(()=>{var n,a;const s=(n=v.current[e])==null?void 0:n.firstElementChild;s&&((a=N.current)==null||a.observe(s,{childList:!1,attributes:!0,subtree:!1,attributeFilter:["style"]}),D(s))},0)},X=()=>{const e=new Array(t.length).fill(h),s=t.filter(o=>!r.includes(o.id));let n=y.height-s.length*h,a=0;const c=[];r.forEach(o=>{var w,m;const l=t.findIndex(C(o)),d=t[l],f=(w=d.config)==null?void 0:w.grow;if(f===0){const z=(m=v.current[d.id])==null?void 0:m.firstElementChild,H=((z==null?void 0:z.getBoundingClientRect().height)??0)+h;e[l]=H,n-=H,W(d.id)}else a+=f??1,c.push(l)});const E=n/a;c.forEach(o=>{var f;const d=((f=t[o].config)==null?void 0:f.grow)??1;e[o]=E*d}),R(e)};x.useEffect(()=>{X()},[r,y.height]);function D(e){if(e){const s=e.parentElement,n=t.findIndex(c=>c.id===s.dataset.contentKey),a=e.getBoundingClientRect().height;R(c=>{const E=a+h-c[n];c[n]=a+h;const o=t.findIndex((l,d)=>F.current.includes(l.id)&&d>n);return o===-1?[...c]:(c[o]-=E,[...c])})}}const Y=e=>{const s=[...r];if(s.includes(e)){const n=s.indexOf(e);s.splice(n,1)}else s.push(e);_==null||_(s)},$=y.height===0||A.every(e=>e===0);return i.jsxs("div",{ref:q,className:S(u.collapse,p),title:g,style:j,role:O,children:[i.jsx(k,{active:$}),i.jsx(G,{sizes:A,split:"horizontal",paneClassName:S(u.pane),onChange:R,children:t.map((e,s)=>{var o,l,d,f,w;const n=r.includes(e.id),a=r.includes((o=t[s-1])==null?void 0:o.id),c=n&&a,E=((l=e.config)==null?void 0:l.grow)!==0&&((f=(d=t[s-1])==null?void 0:d.config)==null?void 0:f.grow)!==0;return i.jsx(G.Pane,{minSize:h,maxSize:n?1/0:h,resizable:c&&E,hidden:e.hidden,children:i.jsxs("div",{className:S(u.item,e.className,n&&u.active),children:[i.jsx(Q,{onContextMenu:m=>I==null?void 0:I({x:m.pageX,y:m.pageY},e),children:i.jsxs(L,{className:u.header,tabIndex:0,justifyContent:"space-between",onClick:()=>Y(e.id),children:[i.jsxs(L,{children:[i.jsx(U,{type:n?"chevron-down":"chevron-right"}),i.jsx("span",{className:u.title,children:e.name})]}),n&&i.jsx(V,{className:u.extra,data:e.toolbar||[],onClick:m=>b==null?void 0:b(m,e.id)},e.id)]})}),i.jsx(Z,{visible:n,delay:Number(u.transitionDelay),children:i.jsx("div",{className:u.content,tabIndex:0,ref:v(e.id),"data-content-key":e.id,children:(w=e.render)==null?void 0:w.call(e,e)})})]})},e.id)})})]})}function re({onToolbarClick:t,onCollapseChange:r,onContextMenu:p}){const g=M("explorer"),j=g.data.concat().sort(T);return j.length?i.jsx(te,{data:j,activePanelKeys:g.active,onCollapseChange:r,onToolbarClick:t,onContextMenu:p}):null}export{re as default};
